## Анализа

Уместо да посматрамо проблем "из перспективе круга", нађимо за сваку праву скуп кругова имају пресек са њом. Како је $i$-ти круг садржан у наредном, ако права сече $i$-ти круг, тада сигурно сече и сваки наредни, што значи да овај скуп кругова чини сегмент, притом, суфикс, низа кругова. Нађимо, дакле, за сваку праву најмањи круг који се сече са њом. Из горе изложеног закључујемо да се овај круг може наћи бинарном претрагом по круговима - ако се неки круг не сече са правом, настављамо претрагу по већим круговима, иначе, памтимо решење и тражимо међу мањим круговима. Након што смо нашли индекс $j$ овог најмањег круга, у низу решења $z$ треба бројевима $z_j, z_{j+1}, \ldots, z_n$ да додамо $1$, што можемо урадити тако што додамо $1$ броју $z_j$ а након што обрадимо све праве израчунамо префиксну суму низа $z$, коју штампамо. 

## Смернице за алгоритам

Да бисмо испитали да ли се права одређена двема тачкама $A, B$ сече са кругом радијуса $r$ са центром у тачки $C$, најједноставнији начин је да нађемо удаљеност праве $AB$ до тачке $C$ и да тај број упоредимо са $r$. Израчунајмо двоструку површину троугла $ABC$ као апсолутну вредност векторског производа $2P = |CA \times CB|$ и дужину дужи $|AB|$. Како је удаљеност праве $AB$ од $C$ заправо висина троугла $h_C$, ту висину можемо израчунати преко површине: $h_C = \frac{2P}{|AB|}$. Притом, све ове операције се могу поуздано израчунати помоћу типа `double` са релативном прецизношћу $10^{-14}$ што је довољно добро за овај задатак.